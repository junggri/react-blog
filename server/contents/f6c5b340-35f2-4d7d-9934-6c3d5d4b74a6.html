<pre class="ql-syntax" spellcheck="false">
<span class="hljs-keyword">import</span> React, { useCallback, useEffect, useRef, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> ReactQuill <span class="hljs-keyword">from</span> <span class="hljs-string">"react-quill"</span>;
<span class="hljs-keyword">import</span> WriteTopicName <span class="hljs-keyword">from</span> <span class="hljs-string">"component/Write/WriteTopicName"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">"react-quill/dist/quill.snow.css"</span>;
<span class="hljs-keyword">import</span> { WriteBox, WriteConditionBox } <span class="hljs-keyword">from</span> <span class="hljs-string">"../../styled-comp"</span>;
<span class="hljs-keyword">import</span> { formats, modules } <span class="hljs-keyword">from</span> <span class="hljs-string">"../../config/textEditor.config"</span>;
<span class="hljs-keyword">import</span> { SelectTopic } <span class="hljs-keyword">from</span> <span class="hljs-string">"../index"</span>;
<span class="hljs-keyword">import</span> util <span class="hljs-keyword">from</span> <span class="hljs-string">"../../lib/axios"</span>;
<span class="hljs-keyword">import</span> { WriteBtnBox } <span class="hljs-keyword">from</span> <span class="hljs-string">"component/index"</span>;

const Editor = <span class="hljs-function"><span class="hljs-params">({ history }: any)</span> =&gt;</span> {
   const [value, setValue] = useState(<span class="hljs-string">""</span>);
   const [contentName, setContentName] = useState(<span class="hljs-string">""</span>);
   const [topic, setTopic] = useState(<span class="hljs-string">""</span>);
   const ref: any = useRef(<span class="hljs-literal">null</span>);

   useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      ref.current.focus();
   }, []);

   const onNameChange = useCallback(<span class="hljs-function"><span class="hljs-params">(data: string)</span> =&gt;</span> {
      setContentName(data);
   }, []);

   const rteChange = <span class="hljs-function"><span class="hljs-params">(content: any, delta: any, source: any, editor: any)</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(delta.insert.image, delta);
      setValue(ref.current.state.value);
   };

   const onIsChecked = useCallback(<span class="hljs-function"><span class="hljs-params">(name: string)</span> =&gt;</span> {
      setTopic(name);
   }, []);


   const onSubmit = useCallback(async (e: any) =&gt; {
      e.preventDefault();
      <span class="hljs-keyword">if</span> (value &amp;&amp; contentName &amp;&amp; topic) {
         const contents = {
            contentName: contentName,
            content: value,
            topic: topic,
         };
         const { data } = <span class="hljs-keyword">await</span> util.getCSRTtoken();
         const state = <span class="hljs-keyword">await</span> util.checkCSRFtoken(data);
         <span class="hljs-keyword">if</span> (state) {
            let result = <span class="hljs-keyword">await</span> util.savePost(contents);
            <span class="hljs-keyword">if</span> (result) history.push(<span class="hljs-string">"/"</span>);
         }
      } <span class="hljs-keyword">else</span> {
         alert(<span class="hljs-string">"내용을 입력하세요"</span>);
         <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
   }, [contentName, value, topic]);


   <span class="hljs-keyword">return</span> (
      &lt;&gt;
         &lt;WriteBox&gt;
            &lt;WriteTopicName onNameChange={onNameChange} /&gt;
            &lt;ReactQuill theme=<span class="hljs-string">"snow"</span> onChange={rteChange} modules={modules} formats={formats} placeholder=<span class="hljs-string">"입력하세요."</span> ref={ref} /&gt;
         &lt;/WriteBox&gt;
         &lt;WriteConditionBox&gt;
            &lt;SelectTopic onIsChecked={onIsChecked} /&gt;
            &lt;WriteBtnBox onSubmit={onSubmit} /&gt;
         &lt;/WriteConditionBox&gt;
      &lt;/&gt;
   );
};


<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Editor;
<span class="hljs-keyword">import</span> React, { useCallback, useEffect, useRef, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> ReactQuill <span class="hljs-keyword">from</span> <span class="hljs-string">"react-quill"</span>;
<span class="hljs-keyword">import</span> WriteTopicName <span class="hljs-keyword">from</span> <span class="hljs-string">"component/Write/WriteTopicName"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">"react-quill/dist/quill.snow.css"</span>;
<span class="hljs-keyword">import</span> { WriteBox, WriteConditionBox } <span class="hljs-keyword">from</span> <span class="hljs-string">"../../styled-comp"</span>;
<span class="hljs-keyword">import</span> { formats, modules } <span class="hljs-keyword">from</span> <span class="hljs-string">"../../config/textEditor.config"</span>;
<span class="hljs-keyword">import</span> { SelectTopic } <span class="hljs-keyword">from</span> <span class="hljs-string">"../index"</span>;
<span class="hljs-keyword">import</span> util <span class="hljs-keyword">from</span> <span class="hljs-string">"../../lib/axios"</span>;
<span class="hljs-keyword">import</span> { WriteBtnBox } <span class="hljs-keyword">from</span> <span class="hljs-string">"component/index"</span>;

const Editor = <span class="hljs-function"><span class="hljs-params">({ history }: any)</span> =&gt;</span> {
   const [value, setValue] = useState(<span class="hljs-string">""</span>);
   const [contentName, setContentName] = useState(<span class="hljs-string">""</span>);
   const [topic, setTopic] = useState(<span class="hljs-string">""</span>);
   const ref: any = useRef(<span class="hljs-literal">null</span>);

   useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      ref.current.focus();
   }, []);

   const onNameChange = useCallback(<span class="hljs-function"><span class="hljs-params">(data: string)</span> =&gt;</span> {
      setContentName(data);
   }, []);

   const rteChange = <span class="hljs-function"><span class="hljs-params">(content: any, delta: any, source: any, editor: any)</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(delta.insert.image, delta);
      setValue(ref.current.state.value);
   };

   const onIsChecked = useCallback(<span class="hljs-function"><span class="hljs-params">(name: string)</span> =&gt;</span> {
      setTopic(name);
   }, []);


   const onSubmit = useCallback(async (e: any) =&gt; {
      e.preventDefault();
      <span class="hljs-keyword">if</span> (value &amp;&amp; contentName &amp;&amp; topic) {
         const contents = {
            contentName: contentName,
            content: value,
            topic: topic,
         };
         const { data } = <span class="hljs-keyword">await</span> util.getCSRTtoken();
         const state = <span class="hljs-keyword">await</span> util.checkCSRFtoken(data);
         <span class="hljs-keyword">if</span> (state) {
            let result = <span class="hljs-keyword">await</span> util.savePost(contents);
            <span class="hljs-keyword">if</span> (result) history.push(<span class="hljs-string">"/"</span>);
         }
      } <span class="hljs-keyword">else</span> {
         alert(<span class="hljs-string">"내용을 입력하세요"</span>);
         <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
   }, [contentName, value, topic]);


   <span class="hljs-keyword">return</span> (
      &lt;&gt;
         &lt;WriteBox&gt;
            &lt;WriteTopicName onNameChange={onNameChange} /&gt;
            &lt;ReactQuill theme=<span class="hljs-string">"snow"</span> onChange={rteChange} modules={modules} formats={formats} placeholder=<span class="hljs-string">"입력하세요."</span> ref={ref} /&gt;
         &lt;/WriteBox&gt;
         &lt;WriteConditionBox&gt;
            &lt;SelectTopic onIsChecked={onIsChecked} /&gt;
            &lt;WriteBtnBox onSubmit={onSubmit} /&gt;
         &lt;/WriteConditionBox&gt;
      &lt;/&gt;
   );
};


<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Editor;
</pre>